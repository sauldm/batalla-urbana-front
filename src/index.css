@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {

  html,
  body {
    height: 100%;
  }

  body {
    @apply bg-game-back text-game-text-main font-body;
  }

  h1 {
    @apply font-title text-title text-game-text-title;
  }

  h2 {
    @apply font-title text-subtitle text-game-text-title;
  }

  h3 {
    @apply font-title text-[20px] text-game-text-secondary;
  }

  p {
    @apply font-body text-paragraph text-game-text-secondary;
  }

  button {
    @apply rounded-lg font-body text-button bg-game-highlight text-game-text-inverse shadow-md transition-all duration-150 px-4 py-2;
  }

  button:hover {
    @apply brightness-90 ring-2 ring-game-highlight;
  }

  button:active {
    @apply shadow-sm translate-y-0.5;
  }

  button:disabled {
    @apply opacity-50 cursor-not-allowed brightness-75;
  }

  .card {
    @apply bg-game-board rounded-md shadow-md border border-black/20 transition-all duration-200;
  }

  .card:hover {
    @apply shadow-lg -translate-y-1;
  }

  .modal-backdrop {
    @apply fixed inset-0 bg-black/50 z-40;
  }

  .modal {
    @apply fixed inset-0 z-50 flex items-center justify-center;
  }

  .modal-content {
    @apply bg-game-back border-2 border-game-board rounded-xl shadow-2xl p-6 max-w-md w-full;
  }


  .layout {
    @apply grid grid-cols-12 gap-6;
  }

}

@layer components {

  .text-on-board {
    @apply text-game-text-inverse;
  }


  /* CONTENEDORES GRANDES */
  .container-game {
    @apply px-6 py-6 desktop:px-8 desktop:py-8;
  }

  /* TARJETAS / BOTONES / PANELES */
  .box {
    @apply p-4 desktop:p-6;
  }

  /* MARGENES ENTRE SECCIONES GRANDES */
  .section {
    @apply mb-8 desktop:mb-10;
  }

  /* ESPACIO ENTRE TITULO Y CONTENIDO */
  .block {
    @apply mb-4 desktop:mb-6;
  }

  /* ICONOS Y TEXTO BREVE */
  .inline {
    @apply mr-2;
  }


  .tablero {
    display: grid;
    grid-template-columns: 1fr 3fr 1fr;
    grid-template-rows: repeat(4, minmax(0, 1fr));
    width: 100%;
    /* fill the height of the parent (parent will govern available height via flex) */
    height: 100%;
    overflow: hidden;
    gap: 8px;
    box-sizing: border-box;
    padding: 8px;
  }

  /* MOBILE: < 768px */
  @media (max-width: 767px) {
    .tablero {
      grid-template-columns: repeat(3, 1fr);
      grid-auto-rows: minmax(48px, 1fr);
      gap: 6px;
      padding: 8px;
      /* tighter max height on small screens and allow inner scroll */
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .celda {
      padding: 6px;
      min-height: 48px;
      align-items: flex-start;
      justify-content: center;
    }

    .imagen-centro {
      width: 70%;
      height: auto;
      max-height: 40vh;
    }

    .player-hand {
      gap: 8px;
      padding: 0 4px;
      max-height: 120px;
      overflow-x: auto;
    }
  }

  /* TABLET: ajustes intermedios */
  @media (min-width: 768px) and (max-width: 1199px) {
    .tablero {
      grid-template-columns: 1fr 3fr 1fr;
      gap: 8px;
    }

    .celda {
      padding: 8px;
    }
  }

  .celda {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    min-height: 0;
    min-width: 0;
    overflow: hidden;
    /* ensure cell occupies its grid area */
    height: 100%;
    flex: 1 1 auto;

    /* enable container queries so children can scale proportionally */
    container-type: inline-size;
    /* base font size for scaling children (1rem == 16px) */
    font-size: 1rem;
  }

  /* Prevent inner elements from overflowing their parent cell */
  .celda > * {
    max-height: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  /* Controls inside a cell (e.g., buy/build buttons) */
  .controls {
    width: 100%;
    max-height: 100%;
    overflow-y: auto;
    padding-right: 4px; /* space for scrollbar */
  }

  /* Container queries: scale down/up based on the cell width */
  @container (max-width: 260px) {
    .celda { font-size: 0.85rem; }
    .controls { gap: 0.4em; }
    .controls button { padding: 0.45em 0.6em; font-size: 0.95em; }
    .card-component { width: 88%; }
  }

  @container (max-width: 190px) {
    .celda { font-size: 0.78rem; }
    .controls { gap: 0.3em; }
    .controls button { padding: 0.35em 0.5em; font-size: 0.9em; }
    .card-component { width: 80%; }
  }

  @container (min-width: 400px) {
    .celda { font-size: 1.02rem; }
    .card-component { width: 100%; }
  }

  /* Controls inside a cell (e.g., buy/build buttons) */
  .controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-height: 100%;
    overflow-y: auto;
    padding-right: 4px; /* space for scrollbar */
    gap: 0.5em;
  }

  /* Auto-width buttons that grow with content but are capped by max-width */
  .controls .btn-action {
    display: inline-block;
    width: auto;          /* adjust to content */
    max-width: 50%;       /* limit by default */
    min-width: 8ch;       /* interactive minimum */
    margin: 0.5em auto;
    padding: clamp(6px, 1.8vw, 10px);
    font-size: clamp(0.75rem, 1.4vw, 1rem);
    min-height: 36px;
    box-sizing: border-box;
    text-align: center;
    white-space: normal;  /* allow wrapping */
  }

  @media (max-width: 767px) {
    .controls .btn-action {
      width: 100%;
      max-width: 100%;
      padding: clamp(6px, 2.4vw, 10px);
    }
  }

  /* container override: make buttons full width if cell is narrow */
  @container (max-width: 260px) {
    .controls .btn-action {
      width: 100%;
      max-width: 100%;
    }
  }

  /* Card component: responsive width and fixed aspect ratio */
  .card-component {
    /* visual styles aligned with .card utility but using the brown highlight background */
    background-color: #876b4b;
    border-radius: 0.375rem;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
    border: 1px solid rgba(0,0,0,0.2);
    transition: all 200ms ease;

    width: 100%;
    aspect-ratio: 3 / 4;
    display: flex;
    flex-direction: column;
    gap: 0.5em;
    align-items: center;
    justify-content: flex-start;
    padding: 0.75em; /* use em so it scales with container font-size */
    box-sizing: border-box;
    flex: 0 1 auto;
    min-width: 64px;
  }

  /* Card rows (scrollable or grouped) should cap card width so cards don't overflow their row container */
  .card-row {
    display: flex;
    gap: 0.5em;
    align-items: center;
    justify-content: center;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    container-type: inline-size;
  }

  .card-row .card-component {
    flex: 0 0 auto;
    width: clamp(64px, 20vw, 140px);
  }

  .card-component img {
    width: 70%;
    height: auto;
    max-height: 60%;
    object-fit: contain;
  }

  .card-component p {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    text-align: center;
    font-size: 0.95em; /* relative to container font-size */
  }

  .imagen-centro {
    width: 60%;
    height: 60%;
    object-fit: contain;
  }

  .player-hand {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    max-width: 100%;
  }

  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }

  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  @keyframes toast-in {
    from {
      opacity: 0;
      transform: translate(-50%, 20px);
    }

    to {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }

  .animate-toast-in {
    animation: toast-in 0.3s ease-out;
  }

}